<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resonance Pro - Daily Affirmations</title>
    <meta name="description" content="A 30-day journey of daily affirmations and personal reflection based on The Architecture of Resonance. Transform your life through mindful practice.">
    <meta name="theme-color" content="#050515" />
    <link rel="manifest" href="/Daily-Affirmations-app/manifest.json" />
    <!-- iOS PWA icon and meta -->
    <link rel="apple-touch-icon" href="/Daily-Affirmations-app/aurilux-coin-192.png" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
    <style>
        @keyframes shine {
            0% { left: -100%; opacity: 0; }
            50% { opacity: 0.5; }
            100% { left: 200%; opacity: 0; }
        }
        .animate-shine {
            animation: shine 3s infinite linear;
        }
        .perspective-1000 {
            perspective: 1000px;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
        <!-- Install (A2HS) button with icon -->
        <button id="install-fab" title="Install Resonance" style="
            position: fixed; right: 16px; bottom: 80px; z-index: 9999;
            display: flex; width: 56px; height: 56px; border-radius: 16px;
            background: linear-gradient(135deg,#FFD700,#FDB931); 
            border: 2px solid rgba(255,255,255,0.2);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3), 0 0 20px rgba(255,215,0,0.2);
            padding: 0; overflow: hidden; justify-content: center; align-items: center;
            transition: transform 0.2s, box-shadow 0.2s; cursor: pointer;
        " onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">
            <img src="/Daily-Affirmations-app/aurilux-coin-192.png" alt="Install" style="width: 100%; height: 100%; object-fit: cover; border-radius: 14px;">
        </button>
        <div id="ios-tip" style="
            position: fixed; left: 0; right: 0; bottom: 80px; z-index: 9998;
            display: none; padding: 12px; background: #222; color: #FFD700; text-align: center;
            font-size: 15px; border-radius: 12px; margin: 0 16px;
        ">
            <b>iOS:</b> Tap <span style="background:#FFD700;color:#222;padding:2px 6px;border-radius:6px;">Share</span> &rarr; <b>Add to Home Screen</b> to install this app.
        </div>

        <!-- A2HS Banner -->
        <div id="install-banner" style="
            position: fixed; left: 0; right: 0; bottom: 0; z-index: 9999;
            display: none; padding: 12px; backdrop-filter: blur(8px);
            background: rgba(5,5,21,0.8); border-top: 1px solid rgba(255,255,255,0.1);
            color: white; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', 'Noto Sans', Arial;
        ">
            <div style="max-width: 900px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; gap: 12px;">
                <span style="font-size: 13px; opacity: 0.85;">Add "Resonance" to your Home Screen for a full-screen experience.</span>
                <div style="display:flex; gap:8px;">
                    <button id="install-dismiss" style="padding:8px 12px; background: transparent; color: #bbb; border: 1px solid rgba(255,255,255,0.15); border-radius: 8px;">Not now</button>
                    <button id="install-button" style="padding:8px 12px; background: linear-gradient(90deg, #FFD700, #FDB931); color: #000; font-weight: 700; border: none; border-radius: 8px;">Add to Home Screen</button>
                </div>
            </div>
        </div>

    <script type="text/babel" src="/Daily-Affirmations-app/app.js"></script>

        <script>
            // Register service worker
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                      navigator.serviceWorker.register('/Daily-Affirmations-app/sw.js');
                });
            }

            // A2HS custom banner
            let deferredPrompt;
            const banner = document.getElementById('install-banner');
            const btn = document.getElementById('install-button');
            const dismiss = document.getElementById('install-dismiss');
            const fab = document.getElementById('install-fab');

            function isIOS() {
                return /iphone|ipad|ipod/i.test(navigator.userAgent);
            }
            function isSafari() {
                return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
            }

            // Always show install button on Chrome/Edge/iOS
            if (fab) fab.style.display = 'flex';
            
            window.addEventListener('beforeinstallprompt', (e) => {
                console.log('✅ PWA Install prompt ready - app can be installed as standalone');
                e.preventDefault();
                deferredPrompt = e;
                banner.style.display = 'block';
                if (fab) fab.style.display = 'flex';
                if (iosTip) iosTip.style.display = 'none';
            });
            
            // Debug: Check if service worker registered
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistration().then(reg => {
                    if (reg) console.log('✅ Service Worker active - PWA ready');
                    else console.log('❌ Service Worker not registered');
                });
            }

            // Always show install button on iOS Safari
            const iosTip = document.getElementById('ios-tip');
            if (isIOS() && isSafari()) {
                if (fab) fab.style.display = 'flex';
                if (iosTip) iosTip.style.display = 'block';
            }

            btn && btn.addEventListener('click', async () => {
                if (!deferredPrompt) return;
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
                banner.style.display = 'none';
                if (fab) fab.style.display = 'none';
            });

            dismiss && dismiss.addEventListener('click', () => {
                banner.style.display = 'none';
            });

            // Floating button click
            fab && fab.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    deferredPrompt = null;
                    banner.style.display = 'none';
                    fab.style.display = 'none';
                    return;
                }
                // Fallback for Chrome/Edge/iOS
                if (isIOS() && isSafari()) {
                    iosTip.style.display = 'block';
                    setTimeout(() => { iosTip.style.display = 'none'; }, 7000);
                    return;
                }
                alert('To install: On Chrome/Edge, use browser menu → Install app. On iPhone/iPad, use Share → Add to Home Screen.');
            });

            // Hide UI if already installed
            window.addEventListener('appinstalled', () => {
                banner.style.display = 'none';
                if (fab) fab.style.display = 'none';
            });
        </script>
</body>
</html>